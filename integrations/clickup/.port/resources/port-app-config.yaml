createMissingRelatedEntities: true
deleteDependentEntities: true
resources:
  - kind: team
    selector:
      query: "true"
    port:
      entity:
        mappings:
          identifier: .id
          title: .name
          blueprint: '"clickupTeam"'
          properties:
            url: .id | "https://app.clickup.com/" + . + "/v/o/s/default_space"
            members: .members[].email
  - kind: project
    selector:
      query: "true"
    port:
      entity:
        mappings:
          identifier: .id
          title: .name
          blueprint: '"clickupProject"'
          properties:
            url: .id | "https://app.clickup.com/t/" + .
            startDate: .start_date | tonumber | todate
            endDate: .end_date | tonumber | todate
            totalIssues: .issue_count
          relations:
            team: __team_id
  - kind: issue
    selector:
      query: "true"
    port:
      entity:
        mappings:
          identifier: .id
          title: .name
          blueprint: '"clickupIssue"'
          properties:
            url: .url
            description: .description
            status: .status.status
            assignee: .assignees[0].email
            creator: .creator.email
            priority: .priority.priority | tostring
            created: .date_created | tonumber | (. /1000 | strftime("%Y-%m-%dT%H:%M:%SZ"))
            updated: .date_updated | tonumber | (. /1000 | strftime("%Y-%m-%dT%H:%M:%SZ"))
          relations:
            project: .project.id
